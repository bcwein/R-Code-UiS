---
title: "Exercise set 1 - Week 35"
author: "Bj√∏rn Christian Weinbach"
date: 20.08.2020
output:
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

This notebook is shows my solution to the exercise sheet for week 35 in STA510 course at the University of Stavanger.

# Problem 1

Consider the experiment of flipping an unbiased coin 5 independent times. Let H 
denote the outcome "head" and T to denote "tails".

\begin{enumerate}
  \item Compute the probability of HHTHT and THHHT.
  \newcounter{enumTemp}
  \setcounter{enumTemp}{\theenumi}
\end{enumerate}

We have two events, HHTHT and THHHT which are two events in the sample space of
all possible outcomes of 5 coin flips, the probability $P(\text{HHTHT}) / n$ 
where $n$ is all possible outcomes.

$n$ can be calculated using the \textbf{fundemental counting principle} which 
gives us:

\begin{equation}
n = 2*2*2*2*2 = 2^5 = 32
\end{equation}

Therefore, for each of the two events above, the probability of one of them
occuring is $1/32$.

\begin{enumerate}
  \setcounter{enumi}{\theenumTemp}
  \item \label{simulation} Modify the R-code from the number of heads example
  in the lectures to simulate the probability of three heads occurring in the 5 trials.
  \setcounter{enumTemp}{\theenumi}
\end{enumerate}

## Function for simulationg number of heads
```{r}
# Simulate the number of heads in k throws of a dice repeated Nsim times
# We let 0 correspond to tail and 1 correspond to head,
# The sample()-command below randomly draw a 0 or 1 with 
# equal probability k times, and then sum() will summarize the number of heads
simheads <- function(Nsim,k){
  nheads <- vector(length=Nsim) # Define a vector to store the number of heads 
  for(i in 1:Nsim)              # Generate the number of heads Nsim times
    nheads[i] <- sum(sample(0:1,size=k,replace=TRUE))  # See explanation above
  return(nheads)                # Return the resulting vector
}
```
## Simulate and plot barplot
```{r}
# Summarize the results by histograms and numbers
# Repeat the lines below many times for different numbers of Nsim and k
# What happens when Nsim gets large?
k <- 5
Nsim <- 1000
nheadsim <- simheads(Nsim=Nsim,k=k)
relfreq <- table(nheadsim)/Nsim # Calculate relative frequency for each outcome
relfreq
barplot(relfreq,ylab="Relative frequency")
```
## Exact probability
We introduce the random variable $X = \text{number of heads}$. The exact
probability $P(X = 3)$ is calculated using the binomial distribution with
parameters $n = 3$ and $p = 0.5$.

In R, this is done so:

```{r}
x <- dbinom(3, size=5, prob=0.5)
print(x)
```
Which tells us that the probability of getting 3 heads out of 5 coin tosses
is 31.25 \%.

\begin{enumerate}
  \setcounter{enumi}{\theenumTemp}
  \item Redo point \ref{simulation} for a biased coin for which the probability
  of heads is 0.6.
  \setcounter{enumTemp}{\theenumi}
\end{enumerate}

## Biased function
```{r}
# Same function as above but with a biased coin. b is bias variable
simbias <- function(Nsim,k,b){
  nheads <- vector(length=Nsim) # Define a vector to store the number of heads
  for(i in 1:Nsim)              # Generate the number of heads Nsim times
    nheads[i] <- sum(sample(0:1,size=k,replace=TRUE, prob=c(1-b, b)))
  return(nheads)                # Return the resulting vector
}
```

## Simulate and summarise

```{r}
# Summarize the results by histograms and numbers
# Repeat the lines below many times for different numbers of Nsim and k
# What happens when Nsim gets large?
k <- 5
Nsim <- 1000
b <- 0.6
nheadsim <- simbias(Nsim=Nsim,k=k,b=b)
relfreq <- table(nheadsim)/Nsim # Calculate relative frequency for each outcome
relfreq
barplot(relfreq,ylab="Relative frequency")
```

# Problem 2

For each of the following, determine the constant c such that f(x) satises the
condition of being the probability mass function (pmf) for a discrete random 
variable X, and then depict each f(x) as a bar graph:

## a)
Given the function

\begin{equation}
f(x) = x/c, \quad x = 1,2,3,4
\end{equation}

for the function qualify as a pmf the constant $c$ should have a value such that

\begin{equation}
\sum_{i = 1}^{4} f(x_i) = 1
\end{equation}

Therefore, c can be calculated as follows

\begin{equation}
1/c + 2/c + 3/c + 4/c = 1 \implies c = 10
\end{equation}

## The function i R
```{r}
# Define f1(x)
# The function takes in a vecor and checks if it is valid
# function calculates pmf
f1 <- function(x) {
  ifelse(x %in% c(1, 2, 3, 4),
         x/10,
         0)
}

barplot(f1(1:4),ylab="Relative frequency", xlab="x")
```
we see that the function is a valid pmf since:

```{r}
sum(f1(-100:100))
```

## b)

Given the function

\begin{equation}
f(x) = c(x + 1)^2, \quad x = 0,1,2,3
\end{equation}

for the function qualify as a pmf the constant $c$ should have a value such that

\begin{equation}
\sum_{i = 0}^{3} f(x_i) = 1
\end{equation}

Therefore, c can be calculated as follows

\begin{equation}
c + 4c + 9c = 1 \implies c = 1/14
\end{equation}

## The function in R
```{r}
# Define f2(x)
# The function takes in a vector and checks if it is valid
# function calculates pmf
f2 <- function(x) {
  ifelse(x %in% c(1, 2, 3, 4),
         (1/14)*(x + 1),
         0)
}

barplot(f2(0:3),ylab="Relative frequency", xlab="x")
```

we see that the function is a valid pmf since:

```{r}
sum(f2(-100:100))
```

# Problem 3
For the probability distributions in problem 2 find $E(X)$ and $E(g(X))$ with 
$g(x) = x^3$.

## Function for expected value

```{r}
expected <- function(func, vec)
  return(sum(vec * func(vec)))
``` 

## Expected value of f1 and f2

```{r}
expected(f1, c(1,2,3,4))
expected(f2, c(1,2,3,4))
```

## Funcion for expected value with $g(x)$

```{r}
gexpected <- function(func, vec, gvec)
  return(sum(gvec * func(vec)))
``` 

## Expected value $E(g(x))

```{r}
gexpected(f1, c(1,2,3,4), c(1,2,3,4)^3)
gexpected(f2, c(1,2,3,4), c(1,2,3,4)^3)
```

# Problem 4

## a)

Calculate $P(X < 0.5)$

$P(X < 0.5)$ is calculated using the integral

\begin{equation}
\int_{-\infty}^{0.5} f(x) dx
\end{equation}

where $f(x)$ is the probability density function for $X$

### Calculate $P(X < 0.5)$ in R
```{r}
f3 <- function(x) {
  if (x >= 0 && x <= 1) {
    return(4*x*(1 - x^2))
  } else {
    return(0)
  } 
}


integrate(Vectorize(f3),
         lower=-Inf,
         upper=0.5)$value
```

### Calculate E(X)

```{r}
integrate(Vectorize(function(x) x * f3(x)),
          lower = -Inf,
          upper = Inf)$value
```
### Calculate Var(X)

```{r}
integrate(Vectorize(function(x) x^2 * f3(x)),
          lower = -Inf,
          upper = Inf)$value
```
### Calculate SD(X)

```{r}
sqrt(integrate(Vectorize(function(x) x^2 * f3(x)),
          lower = -Inf,
          upper = Inf)$value)
```

## b) Calculate $P(X < 0.7)$ and $P(X > 7)$

### $P(X < 0.7)$
```{r}
integrate(Vectorize(f3),
         lower=-Inf,
         upper=0.7)$value
```

### $P(X < 0.7)$
```{r}
1 - integrate(Vectorize(f3),
              lower=-Inf,
              upper=0.7)$value
```
## c) Plot $f(x)$

```{r}
x <- seq(0, 1, 0.01)
plot(x, f3(x), type="l", col= "blue")
```

## c) Plot $F(x)$

```{r}
F3 <- function(x) {
  return(-4*((x^4 / 4)-(x^2 / 2)))
}

x <- seq(0, 1, 0.01)
plot(x, F3(x), type="l", col= "blue")
```
