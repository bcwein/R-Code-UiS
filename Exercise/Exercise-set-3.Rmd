---
title: "Exercise set 3"
output: pdf_document
author: Bj√∏rn Christian Weinbach
date: 01.09.2020
---

# Exercise 3.3

The Pareto(a, b) distribution has cdf
\begin{equation}
  F(x) = 1 - \frac{b^a}{x^a}
\end{equation}

Derive the probability inverse transformation $F^{-1}(U)$ and use the inverse
transform method to to simulate a random sample from the Pareto(2, 2) dist.

The function $F^{-1}$ is derived by setting $F(X) = U$ and solving for X which
gives us.

\begin{equation}
  U = 1 - \frac{4}{x^2} \implies X = \frac{2}{\sqrt{(1-u)}}
\end{equation}

and this we have $F^{-1}(U) = \frac{2}{\sqrt{(1-u)}}$

and in general terms $F^{-1}(U) = \frac{2}{\sqrt{(1-u)}}$

## Calculate using R

```{r}
simPareto <- function(nSim, a, b) {
  u <- runif(nSim)
  return(b*(1-u)^(-1/a))
}

nSim = 1000000
ParetoFx <- simPareto(nSim = nSim, a = 2, b = 2)
hist(ParetoFx, breaks=30, prob=TRUE)
```


# Exercise 3.5

Use the inverse transform method to generate a random sample of size from
distribution

```{r}
# Alternatively the built in sample function can be used 
## Generating data from the number of heads example where 
## f(0)=1/8, f(1)=3/8, f(2)=3/8 and f(3)=1/8

# Function for simulating number of heads according to the distribution above
discrv <- function(Nsim){
   U <- runif(Nsim)
   X <- rep(0,Nsim)
   X[(U>0.1) & (U<=0.3)] <- 1
   X[(U>0.3) & (U<=0.5)] <- 2
   X[(U>0.5) & (U<=0.7)] <- 3
   X[U>0.7] <- 4
   return(X)
}

Nsim <- 10000

dfx <- discrv(Nsim)
relfreq <- table(dfx)/Nsim
barplot(relfreq,ylab="Relative frequency - Inverse transform method")

# Alternatively the built in sample function can be used 
dfx2 <- sample(0:4,size=Nsim,replace=TRUE,prob=c(0.1,0.2,0.2,0.2,0.3))
relfreq <- table(dfx2)/Nsim
barplot(relfreq,ylab="Relative frequency - Sample method")
```


# Exercise 3.7

Write a function to generate a random sample of size n from the beta(a,b)
distribution by the acceptance-rejection method. Sample size should be
1000 from the beta(3,2) distribution. Graph the sample with the theoretical
Beta(3,2) density.

``` {r}
### Examples of acceptance-rejection sampling

## Generating data from the density f(x)=12x^2(1-x) for 0<x<1
# Using the uniform distribution as proposal distribution
genfxdata <- function(Nsim){
  k <- 0 # counter for accepted
  j <- 0 # iterations
  x <- numeric(Nsim) # vector for accepted
  while(k<Nsim){
    u <- runif(1)
    j <- j+1
    y <- runif(1,min=0,max=1) # proposal distribution
    if(u < (12*y^2*(1-y))/(16/9) ){ # Then we accept
      k <- k+1
      x[k] <- y
    }
  }
  print(paste("Performed ",j,"iterations to simulate",Nsim,"data."))
  return(x)
}

# Repeat the lines below for different values of Nsim
Nsim <- 10000
x <- genfxdata(Nsim=Nsim)
# Histogram of simulated data with true density on top as red line
hist(x, prob = TRUE,breaks=seq(0,1,length.out=max(10,sqrt(Nsim))),
     main="Histogram of data and true density")
curve(12*x^2*(1-x), col = "red", lty = 2, lwd = 2, add = TRUE,xlim=c(0,1))
# Mean of the data
mean(x)
# P(X<0.5)
sum(x<0.5)/Nsim
```




